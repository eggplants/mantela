# mantela.json について

mantela.json によって、以下のような情報を簡単に提供できます。

- 自身の交換局の接続情報
- 自身の交換局に接続されている端末の情報
- 自身の交換局と接続されている他の交換局の情報

## mantela.json の記述

**mantela.json** のための JSON Schema を提供しています。
これを利用することで **mantela.json** の記述が妥当であるか検証できます。
また、一部のエディタ（Visual Studio Code など）では、`$schema` の記述によって **mantela.json** の記述を補完してくれる場合があります。

```json
{
    "$schema": "https://kusaremkn.github.io/mantela/mantela.schema.json",
    ...
}
```


## mantela.json の例

**example.json** を参照してください。

## mantela.json の要素

**mantela.schema.json** を併せて参照してください。

### `version`: mantela.json のバージョン

**mantela.json** の記述に用いられる Mantela のバージョンを指定します。
現時点の Mantela のバージョンは 0.0.0 であるため、`"0.0.0"` を指定します。

### `aboutMe`: 自身の交換局の情報

あなた自身の交換局の情報を提供してください。

#### `name`: 交換局の名称

交換局の名称を指定してください。
この名称は人間に対して表示されるものです。
例えば、`"MKNETEL"` や `"Great Genius Pretty Girl's Telephone Network"` などの値を指定できます。

#### `preferredPrefix`: 推奨プレフィクス番号

交換局に紐付けるプレフィクス番号として好ましいものを指定してください。
ただし、このプレフィクス番号を必ずしも利用する、あるいは利用されることを強いるものではありません。
この文脈において、先頭の 0 は意味のあるものであるため、これは文字列値です。
例えば、`"0510"` を指定できます。

好ましいプレフィクス番号が複数ある場合には、配列によって複数の値を指定してください。
例えば、`[ "0510", "510" ]` を指定できます。

#### `identifier`: 交換局の識別子

交換局の識別子を指定してください。
この識別子は機械がそれぞれの識別子を区別するためのものです。
UUIDv4 や ULID、もっと簡単には `head /dev/urandom | md5` で得られるようなハッシュを生成し、これを指定します。
この値は世界中でユニークである必要があります。

#### `sip*`: SIP 接続情報

SIP サーバに接続するための情報を指定してください。
これらの情報に公開したくない項目がある場合、記述を省略できます。

### `extensions`: 内線番号の情報

あなた自身の交換局に接続されている端末の情報を提供してください。

同じ内線番号に複数の端末が紐付けられていたり、同じ端末に複数の内線番号が紐付けられていたりする場合、それらの項目はそれぞれ別の端末として列挙してください。

#### `name`: 端末の名称

端末の名称を指定してください。
この名称は人間に対して表示されるものです。
例えば、`"ivory"` や `"代表番号"` などの値を指定できます。

#### `extension`: 端末の内線番号

端末の内線番号を指定してください。
端末の存在を公開しながら内線番号を公開したくない場合、この値を空文字列や `"XXXX"` のような値にすることができます。
この文脈において、先頭の 0 は意味のあるものであるため、これは文字列値です。
例えば、`"5175"` や `"XXXX"` を指定できます。

#### `identifier`: 端末の識別子

端末の識別子を指定してください。
この識別子は機械が局内におけるそれぞれの端末を区別するためのものです。
UUIDv4 や ULID、もっと簡単には `head -c5 /dev/urandom | base32` で得られるような文字列を生成し、これを指定します。
この値は交換局内でユニークである必要があります。

#### `type`: 端末の種別

端末の種別を指定してください。
以下の値を利用できます。

- alias: 単一の端末に対する転送番号です。
- application: 対話的な機能を有する自動応答端末です。
- cellphone: スマホでない携帯電話機です。
- dialphone: ダイヤルパルスを用いる固定電話機です。
- fax: ファクシミリ機です。
- information: 音声による情報提供を目的とした自動応答端末です。
- main: コールキューや複数の端末に対する転送番号です。
- modem: モデム端末です。
- music: 音声による情報提供を目的としない自動応答端末です。
- other: その他の端末です。（新しい種別のリクエストをお待ちしています）
- phone: 電話機です。
- pushphone: プッシュトーンを用いる固定電話機です。
- reserved: 予約済の番号です。
- smartphone: スマートフォンです。
- switchboard: 対話的に転送先を選択できる転送番号です。
- unknown: 種別の不明な端末です。 そもそも自分が管理している網であるにも拘わらず不明であることなんてありませんから、この値は使われません。 そうですよね？
- unused: 使用されていない番号です。

端末の種別を決定するためのフローチャートです。

![](types.svg)

### `providers`: 接続されている交換局の情報

接続されている他の交換局の情報を提供してください。

同じ交換局に複数のプレフィクス番号が紐付けられている場合、それらの項目はそれぞれ別の交換局として列挙してください。

ここにあなた自身の交換局の情報を含めることができます。
その場合、その接続情報は “交換局ホップ” のために利用されます。

#### `name`: 交換局の名称

交換局の名称を指定してください。
この名称は人間に対して表示されるものです。
例えば、`"Alice's PBX"` や `"BOBNET"` などの値を指定できます。

#### `prefix`: 交換局のプレフィクス番号

交換局のプレフィクス番号を指定してください。
端末の存在を公開しながらプレフィクス番号を公開したくない場合、この値を空文字列や `"XXXX"` のような値にすることができます。
この文脈において、先頭の 0 は意味のあるものであるため、これは文字列値です。
例えば、`"0039"` や `"XXXX"` を指定できます。

#### `identifier`: 交換局の識別子

交換局の識別子を指定してください。
この識別子は機械がそれぞれの識別子を区別するためのものです。
接続先の交換局の **mantela.json** で指定されている値を指定してください。
この値は世界中でユニークである必要があります。

#### `mantela`: 交換局の **mantela.json** の URL

接続先の交換局の **mantela.json** の URL を指定してください。
この URL を辿って相互接続されている交換機の電話網を解析します。
